class DDSGlobal{static instance=null;#e=null;#t=null;#a={};get screen(){return this.#e||{}}set screen(e){this.#e=e}get data(){return this.#t||{}}set data(e){this.#t=e}storeTemplate(e,t,a,s,l,c){return this.#s(e,t,a,s,l,c),c}loadTemplate(e,t,a,s,l){return this.#a[e]?.[t]?.[a]?.[s]?.[l]}#s(...e){let t=this.#a;return e.forEach((e=>{t[e]||(t[e]={}),t=t[e]})),t}toName(e){return'string'==typeof e&&(e=e.split(',')),e.map((e=>e.replace('*','#'))).sort().join('_')}static{DDSGlobal.instance=new DDSGlobal,Object.seal(DDSGlobal)}}var e=DDSGlobal.instance;class DDSData extends HTMLElement{#l=new DOMParser;get templateName(){return e.toName(this.dataset.records)}get template(){const t=this.dataset,a=e.toName(t.records);return e.loadTemplate(t.system,t.partition,t.library,t.object,a)}get url(){const e=this.dataset,t=1==e.rest,a=`${e.url||location.origin}`,s=t?`/${e.system}/${e.partition}/${e.library}/${e.object}/${e.templateName}`:'/',l=t?new URL(s,a):new URL(a);return t||(l.searchParams.append('system',e.system),l.searchParams.append('partition',e.partition),l.searchParams.append('library',e.library),l.searchParams.append('object',e.object),l.searchParams.append('template',e.templateName)),l}async workflow(){const t=this;if(!t.template){const e=await t.load(),a=t.preprocess(e);t.save(a)}return e.data=t.extract(),t.template}async load(){const e=await fetch(this.url);return await e.text()}save(t){const a=this.dataset,s=e.toName(a.records);e.saveTemplate(a.system,a.partition,a.library,a.object,s,t)}preprocess(e){const t=this.#l.parseFromString(e,'text/xml'),a=a.documentElement;Array.from(a.querySelectorAll('dds-window')).forEach((e=>{const a=t.createElement('dds-subfile-control');e.appendChild(a),Array.from(e.attributes).forEach((e=>a.setAttribute(e.name,e.value)))}));return Array.from(a.querySelectorAll('dds-subfile')).forEach((e=>{const t=a.querySelector(`dds-subfile-control[name="${e.getAttribute('sfctl')}"]`);t&&t.appendChild(e)})),a}extract(){this.template,e.screen}static{customElements.define('dds-data',DDSData),Object.seal(DDSData)}}class DDSRender extends HTMLElement{static{customElements.define('dds-render',DDSRender),Object.seal(DDSRender)}}class FaceliftEngine extends HTMLElement{static{customElements.define('facelift-engine',FaceliftEngine),Object.seal(FaceliftEngine)}}class FaceliftElement extends HTMLElement{}class FaceliftAction extends FaceliftElement{static{customElements.define('facelift-action',FaceliftAction),Object.seal(FaceliftAction)}}class FaceliftCombo extends FaceliftElement{static{customElements.define('facelift-combo',FaceliftCombo),Object.seal(FaceliftCombo)}}class FaceliftList extends FaceliftElement{static{customElements.define('facelift-list',FaceliftList),Object.seal(FaceliftList)}}class FaceliftLookup extends FaceliftElement{static{customElements.define('facelift-lookup',FaceliftLookup),Object.seal(FaceliftLookup)}}class FaceliftSubfile extends FaceliftElement{static{customElements.define('facelift-subfile',FaceliftSubfile),Object.seal(FaceliftSubfile)}}class FaceliftWindow extends FaceliftElement{static{customElements.define('facelift-window',FaceliftWindow),Object.seal(FaceliftWindow)}}export{DDSData,e as DDSGlobal,DDSRender,FaceliftAction,FaceliftCombo,FaceliftEngine,FaceliftList,FaceliftLookup,FaceliftSubfile,FaceliftWindow};
//# sourceMappingURL=io.greenscreens.facelift.core.esm.min.js.map
